# üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞

**–î–∞—Ç–∞:** 8 –¥–µ–∫–∞–±—Ä—è 2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –≠–∫–≤–∞–π—Ä–∏–Ω–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω

---

## ‚úÖ –ß–¢–û –£–ñ–ï –°–î–ï–õ–ê–ù–û:

- [x] ‚úÖ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω
- [x] ‚úÖ –°–∞–π—Ç –¥–æ–±–∞–≤–ª–µ–Ω: `gornostyle72.ru/instruktor-po-gornym-lyzham-snoubordy-tyumen`
- [x] ‚úÖ –¢–∞—Ä–∏—Ñ—ã –∏–∑–≤–µ—Å—Ç–Ω—ã:
  - –ö–∞—Ä—Ç—ã: 1% (–¥–æ 500k), 2.3% (–ø–æ—Å–ª–µ)
  - –°–ë–ü: 0% (–¥–æ 500k), 0.7% (–ø–æ—Å–ª–µ)

---

## üìã –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°:

### –®–ê–ì 1: –ü–æ–ª—É—á–∏—Ç—å API credentials (15-30 –º–∏–Ω—É—Ç)

**–ì–¥–µ –∏—Å–∫–∞—Ç—å –≤ –õ–ö –¢–æ—á–∫–∞ –ë–∞–Ω–∫–∞:**

1. **–í —Ä–∞–∑–¥–µ–ª–µ "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥"** (–≥–¥–µ –≤—ã —Å–µ–π—á–∞—Å):
   - –ù–∞–π–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"** –∏–ª–∏ **"API"**
   - –ò–ª–∏ –≤–∫–ª–∞–¥–∫—É **"–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤"**

2. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏:**
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí **"–°–µ—Ä–≤–∏—Å—ã"** ‚Üí **"API"** –∏–ª–∏ **"–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º"**
   - –ò–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ ‚Üí **"–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å:**

- [ ] **Merchant ID** (ID –º–µ—Ä—á–∞–Ω—Ç–∞) - –æ–±—ã—á–Ω–æ –≤–∏–¥–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- [ ] **API Key / Token** - –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] **Customer Code** - –∫–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª–µ)
- [ ] **Webhook Secret Key** - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ webhook
- [ ] **API Base URL** - –æ–±—ã—á–Ω–æ `https://api.tochka.com` –∏–ª–∏ `https://business.tochka.com/api`

**–ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –≤ –õ–ö:**

–ù–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –¢–æ—á–∫–∞ –ë–∞–Ω–∫–∞:
```
–î–æ–±—Ä—ã–π –¥–µ–Ω—å!

–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω.

–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ API –º–Ω–µ –Ω—É–∂–Ω—ã:
1. Merchant ID
2. API Key / Token –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. Webhook Secret Key
4. –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API

–°–ø–∞—Å–∏–±–æ!
```

---

### –®–ê–ì 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Webhook URL (5 –º–∏–Ω—É—Ç)

**–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "Webhooks" –∏–ª–∏ "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è":**

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ URL'—ã:

```
Success URL: https://gornostyle72.ru/instruktor-po-gornym-lyzham-snoubordy-tyumen/booking/success
Fail URL: https://gornostyle72.ru/instruktor-po-gornym-lyzham-snoubordy-tyumen/booking/fail
Webhook URL: https://gornostyle72.ru/api/kuliga/payment/callback
```

**–ì–¥–µ –Ω–∞–π—Ç–∏:**
- –í —Ä–∞–∑–¥–µ–ª–µ "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "Webhooks"
- –ò–ª–∏ "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook"

---

### –®–ê–ì 3: –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API (30 –º–∏–Ω—É—Ç)

**–°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**

1. **–û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - https://developers.tochka.com/docs/tochka-api/api/rabota-s-platyozhnymi-ssylkami
   - https://developers.tochka.com/docs/tochka-api/api/avtorizatsiya-po-jwt-tokenu
   - https://developers.tochka.com/docs/tochka-api/api/rabota-s-vebkhukami

2. **–ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã:**
   - `Create Payment Operation` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
   - `Get Payment Operation Info` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
   - `Refund Payment Operation` - –≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤

**–ß—Ç–æ –∏–∑—É—á–∏—Ç—å:**
- [ ] –§–æ—Ä–º–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (OAuth –∏–ª–∏ JWT)
- [ ] –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- [ ] –§–æ—Ä–º–∞—Ç webhook –æ—Ç –±–∞–Ω–∫–∞
- [ ] –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å webhook

---

### –®–ê–ì 4: –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å .env —Ñ–∞–π–ª (5 –º–∏–Ω—É—Ç)

**–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:**

```bash
# ====================================
# TOCHKA BANK PAYMENT CONFIGURATION
# ====================================
PAYMENT_PROVIDER=tochka

# –¢–æ—á–∫–∞ –ë–∞–Ω–∫ API
TOCHKA_MERCHANT_ID=–≤–∞—à_merchant_id
TOCHKA_CUSTOMER_CODE=–≤–∞—à_customer_code
TOCHKA_API_KEY=–≤–∞—à_api_key
TOCHKA_WEBHOOK_SECRET=–≤–∞—à_webhook_secret
TOCHKA_API_URL=https://api.tochka.com/v1

# –°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –ë—ã—Å—Ç—Ä—ã—Ö –ü–ª–∞—Ç–µ–∂–µ–π)
TOCHKA_ENABLE_SBP=true

# URL –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
PAYMENT_SUCCESS_URL=https://gornostyle72.ru/instruktor-po-gornym-lyzham-snoubordy-tyumen/booking/success
PAYMENT_FAIL_URL=https://gornostyle72.ru/instruktor-po-gornym-lyzham-snoubordy-tyumen/booking/fail
PAYMENT_CALLBACK_URL=https://gornostyle72.ru/api/kuliga/payment/callback

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
PAYMENT_TEST_MODE=false
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ Git!

---

### –®–ê–ì 5: –ù–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ö–æ–≥–¥–∞ –ø–æ–ª—É—á–∏—Ç–µ –≤—Å–µ credentials, –Ω–∞–ø–∏—à–∏—Ç–µ:**

```
‚úÖ –ü–æ–ª—É—á–∏–ª –¥–∞–Ω–Ω—ã–µ –æ—Ç –¢–æ—á–∫–∞ –ë–∞–Ω–∫–∞:
- Merchant ID: [–∑–Ω–∞—á–µ–Ω–∏–µ]
- API Key: [–µ—Å—Ç—å]
- Customer Code: [–∑–Ω–∞—á–µ–Ω–∏–µ]
- Webhook Secret: [–µ—Å—Ç—å]
- API URL: [—Å—Å—ã–ª–∫–∞]
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑—É—á–µ–Ω–∞

–ì–æ—Ç–æ–≤ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!
```

**–ò —è —Å—Ä–∞–∑—É –Ω–∞—á–Ω—É:**
1. –°–æ–∑–¥–∞–Ω–∏–µ TochkaProvider
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ booking flow
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook handler
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –ß–ï–ö-–õ–ò–°–¢ –ü–ï–†–ï–î –ù–ê–ß–ê–õ–û–ú –†–ê–ó–†–ê–ë–û–¢–ö–ò:

- [ ] ‚úÖ –≠–∫–≤–∞–π—Ä–∏–Ω–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω
- [ ] üìÑ –ü–æ–ª—É—á–µ–Ω Merchant ID
- [ ] üîë –ü–æ–ª—É—á–µ–Ω API Key
- [ ] üîë –ü–æ–ª—É—á–µ–Ω Webhook Secret
- [ ] üìö –ò–∑—É—á–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- [ ] üîó –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Webhook URL'—ã
- [ ] üìù –û–±–Ω–æ–≤–ª–µ–Ω .env —Ñ–∞–π–ª
- [ ] üí¨ –ù–∞–ø–∏—Å–∞–ª–∏ –º–Ω–µ "–ì–æ—Ç–æ–≤ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!"

---

## ‚è±Ô∏è –û–†–ò–ï–ù–¢–ò–†–û–í–û–ß–ù–´–ï –°–†–û–ö–ò:

| –≠—Ç–∞–ø | –°—Ä–æ–∫ | –ö—Ç–æ –¥–µ–ª–∞–µ—Ç |
|------|------|------------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ credentials | 1-3 –¥–Ω—è | –í–´ |
| –ò–∑—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ | 30 –º–∏–Ω | –í–´ |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook | 5 –º–∏–Ω | –í–´ |
| –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ TochkaProvider | 2-3 –¥–Ω—è | –Ø |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î | 1 –¥–µ–Ω—å | –Ø |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ booking | 1-2 –¥–Ω—è | –Ø |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook handler | 1 –¥–µ–Ω—å | –Ø |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 2-3 –¥–Ω—è | –°–æ–≤–º–µ—Å—Ç–Ω–æ |
| **–ò–¢–û–ì–û** | **1-2 –Ω–µ–¥–µ–ª–∏** | |

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢ –î–ï–ô–°–¢–í–ò–ô:

### üî• –°–†–û–ß–ù–û (—Å–µ–≥–æ–¥–Ω—è):

1. **–ù–∞–π—Ç–∏ API credentials –≤ –õ–ö**
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook URL'—ã**
3. **–ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** (—Ö–æ—Ç—è –±—ã –±–µ–≥–ª–æ)

### üìÖ –í –¢–ï–ß–ï–ù–ò–ï 1-3 –î–ù–ï–ô:

4. **–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ** (–µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏)
5. **–û–±–Ω–æ–≤–∏—Ç—å .env —Ñ–∞–π–ª**
6. **–ù–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**

---

## üí° –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò:

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:** https://developers.tochka.com/docs/tochka-api/
- **–†–∞–±–æ—Ç–∞ —Å –ø–ª–∞—Ç—ë–∂–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏:** https://developers.tochka.com/docs/tochka-api/api/rabota-s-platyozhnymi-ssylkami
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** https://developers.tochka.com/docs/tochka-api/api/avtorizatsiya-po-jwt-tokenu
- **Webhooks:** https://developers.tochka.com/docs/tochka-api/api/rabota-s-vebkhukami

---

## ‚ùì –ß–ê–°–¢–´–ï –í–û–ü–†–û–°–´:

**Q: –ì–¥–µ –Ω–∞–π—Ç–∏ API credentials?**  
A: –í —Ä–∞–∑–¥–µ–ª–µ "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "API" –∏–ª–∏ "–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤"

**Q: –ß—Ç–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–µ–ª –≤ –õ–ö?**  
A: –ù–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É - –æ–Ω–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ

**Q: –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –±–µ–∑ webhook?**  
A: –ú–æ–∂–Ω–æ, –Ω–æ –ª—É—á—à–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ä–∞–∑—É - –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

**Q: –ù—É–∂–Ω—ã –ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–µ credentials?**  
A: –ù–µ—Ç, –¢–æ—á–∫–∞ –ë–∞–Ω–∫ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ. –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–∞—Ö –º–∞–ª—ã—Ö —Å—É–º–º.

---

**–ì–æ—Ç–æ–≤—ã? –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –®–ê–ì 1 - –∏—â–∏—Ç–µ API credentials! üöÄ**

