# –õ–æ–≥–∏–∫–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∏–º–Ω–∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫

## üìã –û–±–∑–æ—Ä

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≥—Ä—É–ø–ø–æ–≤—ã–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º –Ω–∞ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ, –∑–∏–º–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫–ª–æ–Ω) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤ —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å `scheduled` –û–Ω–∏ —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ –∞—Ä—Ö–∏–≤–∞.

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Cron –∑–∞–¥–∞—á–∞** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (—á–µ—Ä–µ–∑ `src/services/scheduler.js`)
2. **–°–∫—Ä–∏–ø—Ç** `src/scripts/complete-past-group-sessions.js` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:
   - –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞ (–≥—Ä—É–ø–ø–æ–≤—ã–µ)
   - –ó–∏–º–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–≥—Ä—É–ø–ø–æ–≤—ã–µ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ)
3. **–£—Å–ª–æ–≤–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
   - –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `scheduled`
   - –î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ < —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã **–ò–õ–ò**
   - –î–∞—Ç–∞ = —Å–µ–≥–æ–¥–Ω—è **–ò** –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è < —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

### SQL –∑–∞–ø—Ä–æ—Å—ã:

```sql
-- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞ (–≥—Ä—É–ø–ø–æ–≤—ã–µ)
UPDATE training_sessions
SET status = 'completed', updated_at = NOW()
WHERE (slope_type IS NULL OR slope_type = 'simulator')
  AND training_type = TRUE
  AND status = 'scheduled'
  AND (session_date < CURRENT_DATE 
       OR (session_date = CURRENT_DATE AND end_time < CURRENT_TIME))

-- –ó–∏–º–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–≥—Ä—É–ø–ø–æ–≤—ã–µ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ)
UPDATE training_sessions
SET status = 'completed', updated_at = NOW()
WHERE slope_type = 'natural_slope'
  AND status = 'scheduled'
  AND (session_date < CURRENT_DATE 
       OR (session_date = CURRENT_DATE AND end_time < CURRENT_TIME))
```

## üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –∞—Ä—Ö–∏–≤–∞

### –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:

1. **–û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:** `archive-winter-trainings.html`
   - –ö–Ω–æ–ø–∫–∞ "üìã –ê—Ä—Ö–∏–≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫" –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ó–ò–ú–ê"
   - –§–∏–ª—å—Ç—Ä—ã: –¥–∞—Ç–∞ —Å/–ø–æ, —Ç—Ä–µ–Ω–µ—Ä
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–∞–º
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Ü–µ–Ω, —Å—Ç–∞—Ç—É—Å–æ–≤

2. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç:** `GET /api/winter-trainings/archive`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `date_from`, `date_to`, `trainer_id`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `completed` –∏–ª–∏ –ø—Ä–æ—à–µ–¥—à–∏–µ –ø–æ –¥–∞—Ç–µ/–≤—Ä–µ–º–µ–Ω–∏
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∞—Ä—Ö–∏–≤:

- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø—Ä–æ—à–ª–∏ (–¥–∞—Ç–∞ < —Å–µ–≥–æ–¥–Ω—è –∏–ª–∏ –¥–∞—Ç–∞ = —Å–µ–≥–æ–¥–Ω—è –∏ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è < —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è)
- –°—Ç–∞—Ç—É—Å: `completed` –∏–ª–∏ `scheduled` (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ø—Ä–æ—à–µ–¥—à–∏–µ)

## üîç –û—Ç–ª–∏—á–∏—è –æ—Ç —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢—Ä–µ–Ω–∞–∂–µ—Ä | –ó–∏–º–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ |
|----------|----------|-------------------|
| –¢–∏–ø —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ | –¢–æ–ª—å–∫–æ –≥—Ä—É–ø–ø–æ–≤—ã–µ (`training_type = TRUE`) | –ì—Ä—É–ø–ø–æ–≤—ã–µ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ |
| –£—Å–ª–æ–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ | `slope_type IS NULL OR slope_type = 'simulator'` | `slope_type = 'natural_slope'` |
| –ü—Ä–æ—Å–º–æ—Ç—Ä –∞—Ä—Ö–∏–≤–∞ | `archive.html` | `archive-winter-trainings.html` |
| API —ç–Ω–¥–ø–æ–∏–Ω—Ç | `/api/trainings/archive` | `/api/winter-trainings/archive` |

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∏–º–Ω–∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ `completed`
2. ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∞
3. ‚úÖ –û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞—Ä—Ö–∏–≤–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
4. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–∫–Ω–æ–ø–∫–∞ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ)

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –µ–¥–∏–Ω–æ–π –ª–æ–≥–∏–∫–∏

- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ:** –û–¥–∏–Ω–∞–∫–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
- **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –í—Å–µ –ø—Ä–æ—à–µ–¥—à–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∞—Ä—Ö–∏–≤
- **–£–¥–æ–±—Å—Ç–≤–æ:** –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

