# ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è MacroDroid –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### ‚ùå –û—à–∏–±–∫–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```
http://gornostyle72.ru/api/sms/prc
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:**
```
https://gornostyle72.ru/api/sms/process
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–∞ –≤ MacroDroid
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"**
3. –í –ø–æ–ª–µ **"–í–≤–µ–¥–∏—Ç–µ URL-–∞–¥—Ä–µ—Å"** –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞:
   ```
   https://gornostyle72.ru/api/sms/process
   ```
4. ‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **HTTPS** (–Ω–µ HTTP)
5. ‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å `/api/sms/process` (–Ω–µ `/api/sms/prc`)

---

### ‚ùå –û—à–∏–±–∫–∞ 2: –°—Ç–∞—Ä—ã–π IP-–∞–¥—Ä–µ—Å –≤ –ª–æ–≥–∞—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω—ã –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å—Ç–∞—Ä–æ–º—É —Å–µ—Ä–≤–µ—Ä—É:
```
http://90.156.210.24:8080/api/sms/process
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö HTTP-–∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –Ω–æ–≤—ã–π URL (—Å–º. –≤—ã—à–µ)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ –¥—Ä—É–≥–∏—Ö –º–∞–∫—Ä–æ—Å–æ–≤ –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞—Ä—ã–π IP
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∞–∫—Ä–æ—Å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

### ‚ö†Ô∏è –û—à–∏–±–∫–∞ 3: 401 Unauthorized

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å –æ—à–∏–±–∫–∞ `HTTP response code: 401`

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–æ–∫–µ–Ω–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –¢–æ–∫–µ–Ω –æ–±—Ä–µ–∑–∞–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
3. –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–∞ –≤ MacroDroid
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–≥–æ–ª–æ–≤–∫–∞"**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization`:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ:** `Authorization`
   - **–ó–Ω–∞—á–µ–Ω–∏–µ:** `Bearer <–ø–æ–ª–Ω—ã–π_—Ç–æ–∫–µ–Ω>`
   - ‚ö†Ô∏è –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω **–ø–æ–ª–Ω—ã–π** (–Ω–µ –æ–±—Ä–µ–∑–∞–Ω)
   - ‚ö†Ô∏è –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–¥ —Ç–æ–∫–µ–Ω–æ–º –µ—Å—Ç—å —Å–ª–æ–≤–æ `Bearer` —Å –ø—Ä–æ–±–µ–ª–æ–º

4. –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   grep MACRODROID_TOKEN /root/project/gornostyle/.env
   ```

5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑ `MACRODROID_TOKEN=`) –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ MacroDroid

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MacroDroid

### –í–∫–ª–∞–¥–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ú–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ | `POST` |
| URL | `https://gornostyle72.ru/api/sms/process` |
| –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è | ‚úÖ –í–∫–ª—é—á–µ–Ω–æ |
| –†–∞–∑—Ä–µ—à–∏—Ç—å –ª—é–±–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç | ‚ùå –í—ã–∫–ª—é—á–µ–Ω–æ |
| –°–ª–µ–¥–æ–≤–∞—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º | ‚úÖ –í–∫–ª—é—á–µ–Ω–æ |
| –¢–∞–π–º-–∞—É—Ç (—Å–µ–∫) | `30` |

### –í–∫–ª–∞–¥–∫–∞ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–≥–æ–ª–æ–≤–∫–∞"

| –ù–∞–∑–≤–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| `Content-Type` | `application/json` |
| `Authorization` | `Bearer <–ø–æ–ª–Ω—ã–π_—Ç–æ–∫–µ–Ω_–∏–∑_.env>` |

### –í–∫–ª–∞–¥–∫–∞ "–¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è"

**–¢–∏–ø:** –¢–µ–∫—Å—Ç (JSON)

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
```json
{"sms_text":"{sms_message}"}
```

–ì–¥–µ `{sms_message}` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è MacroDroid —Å —Ç–µ–∫—Å—Ç–æ–º SMS.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (–∑–∞–º–µ–Ω–∏—Ç–µ `<—Ç–æ–∫–µ–Ω>` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω):

```bash
curl -X POST https://gornostyle72.ru/api/sms/process \
  -H "Authorization: Bearer <—Ç–æ–∫–µ–Ω>" \
  -H "Content-Type: application/json" \
  -d '{"sms_text": "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —Å—É–º–º—É 100 —Ä. –ù–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞: 1234567890123456"}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—Ö–µ:**
```json
{
  "message": "–ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω",
  "wallet_number": "1234567890123456",
  "client_name": "–ò–º—è –ö–ª–∏–µ–Ω—Ç–∞",
  "new_balance": 100
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ (–∫–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω):**
```json
{
  "message": "–ü–ª–∞—Ç–µ–∂ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω - –∫–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω",
  "saved_to_failed": true
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401):**
```json
{
  "error": "–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ MacroDroid

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∂—É—Ä–Ω–∞–ª –≤ MacroDroid
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ SMS
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –ª–æ–≥–∞—Ö:
   - ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å—Ç–∞—Ä–æ–º—É IP
   - ‚úÖ –ó–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –Ω–∞ `https://gornostyle72.ru/api/sms/process`
   - ‚úÖ HTTP response code: 200 (—É—Å–ø–µ—Ö) –∏–ª–∏ 400 (–∫–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω)
   - ‚ùå –ù–µ—Ç –æ—à–∏–±–æ–∫ 401 (Unauthorized)

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
pm2 logs gornostyle --lines 50
```

–ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
- `üì± –ü–û–õ–£–ß–ï–ù–û SMS –ù–ê –°–ï–†–í–ï–†`
- `üì± –ü–æ–ª—É—á–µ–Ω–æ –°–ú–° –æ—Ç MacroDroid`
- `üí∞ –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–ª–∞—Ç–µ–∂–∞`

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –º–∞–∫—Ä–æ—Å "–ü–∞—Ä—Å–µ—Ä –°–±–µ—Ä" –≤ MacroDroid**

2. **–ù–∞–π–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ "HTTP-–∑–∞–ø—Ä–æ—Å"**

3. **–ò—Å–ø—Ä–∞–≤—å—Ç–µ URL:**
   - –í–∫–ª–∞–¥–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
   - –ü–æ–ª–µ "–í–≤–µ–¥–∏—Ç–µ URL-–∞–¥—Ä–µ—Å"
   - –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞: `https://gornostyle72.ru/api/sms/process`

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:**
   - –í–∫–ª–∞–¥–∫–∞ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–≥–æ–ª–æ–≤–∫–∞"
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å `Authorization: Bearer <—Ç–æ–∫–µ–Ω>`
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –ø–æ–ª–Ω—ã–π –∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–æ–∫–µ–Ω–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
   - –í–∫–ª–∞–¥–∫–∞ "–¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è"
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç: `{"sms_text":"{sms_message}"}`

6. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**

7. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∞–∫—Ä–æ—Å** (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)

8. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ SMS** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å–µ –µ—â–µ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å—Ç–∞—Ä–æ–º—É IP

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ –¥—Ä—É–≥–∏—Ö –º–∞–∫—Ä–æ—Å–æ–≤ —Å HTTP-–∑–∞–ø—Ä–æ—Å–∞–º–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ MacroDroid

### –ü—Ä–æ–±–ª–µ–º–∞: 401 Unauthorized

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `grep MACRODROID_TOKEN /root/project/gornostyle/.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤ MacroDroid —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–æ–∫–µ–Ω–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –µ—Å—Ç—å `Bearer ` –ø–µ—Ä–µ–¥ —Ç–æ–∫–µ–Ω–æ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–π–º-–∞—É—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞: `curl -I https://gornostyle72.ru`
- –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º-–∞—É—Ç –¥–æ 60 —Å–µ–∫—É–Ω–¥
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX


