# üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –¢–∏–Ω—å–∫–æ—Ñ—Ñ –Ω–∞ –¢–æ—á–∫–∞ –±–∞–Ω–∫

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π](#1-–æ–±–∑–æ—Ä-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. [–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ](#2-–∏–∑–º–µ–Ω–µ–Ω–∏—è-–≤-–∫–æ–¥–µ)
3. [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#3-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
4. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏](#4-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–º–∏–≥—Ä–∞—Ü–∏–∏)
5. [–ü–ª–∞–Ω –ø–µ—Ä–µ—Ö–æ–¥–∞](#5-–ø–ª–∞–Ω-–ø–µ—Ä–µ—Ö–æ–¥–∞)

---

## 1. –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

1. **–ü–ª–∞—Ç–µ–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å** (`src/services/kuligaPaymentService.js`)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (–¢–∏–Ω—å–∫–æ—Ñ—Ñ –∏ –¢–æ—á–∫–∞ –±–∞–Ω–∫)
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

2. **–†–æ—É—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π** (`src/routes/kuliga-payment.js`)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤ –æ—Ç –¢–æ—á–∫–∞ –±–∞–Ω–∫–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –≤ –ë–î

3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π `tinkoff_*` –≤ –±–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ `payment_*`
   - –ò–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –¥–ª—è –¢–æ—á–∫–∞ –±–∞–Ω–∫–∞

4. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π –¢–æ—á–∫–∞ –±–∞–Ω–∫–∞
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

---

## 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 2.1. –ü–ª–∞—Ç–µ–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `src/services/kuligaPaymentService.js` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –¢–∏–Ω—å–∫–æ—Ñ—Ñ

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –§–∞–±—Ä–∏–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±–æ–∏—Ö

### 2.2. Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `src/routes/kuliga-payment.js` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ webhook'–∏ –¢–∏–Ω—å–∫–æ—Ñ—Ñ

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏–∑ webhook
- –†–∞–∑–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –ï–¥–∏–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è:
- `tinkoff_status` ‚Üí `payment_status`
- `tinkoff_payment_id` ‚Üí `payment_provider_id`
- `tinkoff_order_id` ‚Üí `payment_order_id`
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `payment_provider` (ENUM: 'tinkoff', 'tochka')

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

–û—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ø–æ–ª—è, –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ:
- `tochka_status`
- `tochka_payment_id`
- `tochka_order_id`
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `payment_provider`

---

## 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –¢–æ—á–∫–∞ –±–∞–Ω–∫–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook'–∏

2. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:**
   - –í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –æ–±–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
   - –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

3. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥:**
   - –°–Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –Ω–∞ –¢–æ—á–∫–∞ –±–∞–Ω–∫
   - –ó–∞—Ç–µ–º —á–∞—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
   - –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥

---

## 5. –ü–ª–∞–Ω –ø–µ—Ä–µ—Ö–æ–¥–∞

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –¥–Ω—è)
- [ ] –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á–∏ –æ—Ç –¢–æ—á–∫–∞ –±–∞–Ω–∫–∞
- [ ] –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### –≠—Ç–∞–ø 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (2-3 –¥–Ω—è)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É webhook'–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å/–ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –≠—Ç–∞–ø 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 –¥–Ω—è)
- [ ] –¢–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook'–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ–∫–æ–≤
- [ ] –ù–µ–±–æ–ª—å—à–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –≠—Ç–∞–ø 4: –ü–µ—Ä–µ—Ö–æ–¥ (1 –¥–µ–Ω—å)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –¢–æ—á–∫–∞ –±–∞–Ω–∫
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- [ ] –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –æ—Ç–∫–∞—Ç—É –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –≠—Ç–∞–ø 5: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (1-2 –¥–Ω—è)
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- [ ] –£–¥–∞–ª–∏—Ç—å –∫–æ–¥ –¥–ª—è –¢–∏–Ω—å–∫–æ—Ñ—Ñ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–ò—Ç–æ–≥–æ:** ~7-11 –¥–Ω–µ–π

---

## üîÑ –û—Ç–∫–∞—Ç –Ω–∞ –¢–∏–Ω—å–∫–æ—Ñ—Ñ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –¢–æ—á–∫–∞ –±–∞–Ω–∫, –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è:

1. –ò–∑–º–µ–Ω–∏—Ç—å `PAYMENT_PROVIDER=tinkoff` –≤ `.env`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ —Å–Ω–æ–≤–∞ –ø–æ–π–¥—É—Ç —á–µ—Ä–µ–∑ –¢–∏–Ω—å–∫–æ—Ñ—Ñ

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 1 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0

