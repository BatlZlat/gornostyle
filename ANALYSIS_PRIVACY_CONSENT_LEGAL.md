# üîç –ê–Ω–∞–ª–∏–∑ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-06  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–ï –°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢ –¢–†–ï–ë–û–í–ê–ù–ò–Ø–ú –§–ó-152**

---

## üìä –¢–ï–ö–£–©–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø

### ‚úÖ –ß—Ç–æ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:

1. **–¢–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
   - ‚úÖ `terms_of_service` - —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤-–æ—Ñ–µ—Ä—Ç (–≤–µ—Ä—Å–∏–∏, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
   - ‚úÖ `user_agreements` - —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–æ–≥–ª–∞—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (client_id, terms_id, agreed_at, ip_address, user_agent)
   - ‚úÖ –ú–∞—Ä—à—Ä—É—Ç `/privacy-policy` –Ω–∞ —Å–∞–π—Ç–µ
   - ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ (`views/privacy-policy.ejs`)

2. **–ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–≥–ª–∞—Å–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ü–î
   - ‚úÖ –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "üìÑ –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø–æ–ª–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π" (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É)
   - ‚úÖ –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∏ "‚úÖ –°–æ–≥–ª–∞—Å–µ–Ω" –∏ "‚ùå –ù–µ —Å–æ–≥–ª–∞—Å–µ–Ω"

### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´):

1. **–°–æ–≥–ª–∞—Å–∏–µ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î:**
   - ‚ùå –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "‚úÖ –°–æ–≥–ª–∞—Å–µ–Ω" (`consent_agree`) —Å–æ–≥–ª–∞—Å–∏–µ **–ù–ï –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è** –≤ —Ç–∞–±–ª–∏—Ü—É `user_agreements`
   - ‚ùå –ù–µ—Ç –∑–∞–ø–∏—Å–∏ –æ —Ç–æ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≥–ª–∞—Å–∏–ª—Å—è —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ü–î
   - ‚ùå –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
   - ‚ùå –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è IP-–∞–¥—Ä–µ—Å–∞ –∏ user agent
   - ‚ùå –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–≥–ª–∞—Å–∏—è

2. **–¢–∞–±–ª–∏—Ü—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**
   - ‚ùå –¢–∞–±–ª–∏—Ü–∞ `user_agreements` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è**
   - ‚ùå –¢–∞–±–ª–∏—Ü–∞ `terms_of_service` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
   - ‚ùå –ù–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–æ–≥–ª–∞—Å–∏–µ–º –∏ –≤–µ—Ä—Å–∏–µ–π –ø–æ–ª–∏—Ç–∏–∫–∏

3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - ‚ùå –ù–µ—Ç —Ç–∞–±–ª–∏—Ü—ã `privacy_policies` –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
   - ‚ùå –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç—Å–ª–µ–¥–∏—Ç—å, —Å –∫–∞–∫–æ–π –≤–µ—Ä—Å–∏–µ–π –ø–æ–ª–∏—Ç–∏–∫–∏ —Å–æ–≥–ª–∞—Å–∏–ª—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
   - ‚ùå –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫—Ç–æ —Å–æ–≥–ª–∞—Å–∏–ª—Å—è —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–µ–π

---

## ‚öñÔ∏è –Æ–†–ò–î–ò–ß–ï–°–ö–ò–ï –†–ò–°–ö–ò

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è –§–ó-152 "–û –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö":

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ —Å–æ–≥–ª–∞—Å–∏—è:**
   - –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–ª —Å–æ–≥–ª–∞—Å–∏–µ
   - –ù–µ—Ç –∑–∞–ø–∏—Å–∏ –æ –≤—Ä–µ–º–µ–Ω–∏ –∏ —É—Å–ª–æ–≤–∏—è—Ö —Å–æ–≥–ª–∞—Å–∏—è
   - –ù–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ –∏ user agent –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

2. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫—Ç–æ —Å–æ–≥–ª–∞—Å–∏–ª—Å—è —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–µ–π
   - –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

3. **–†–∏—Å–∫ —à—Ç—Ä–∞—Ñ–æ–≤:**
   - –®—Ç—Ä–∞—Ñ—ã –æ—Ç –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä–∞ –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –§–ó-152: **–¥–æ 75 000 —Ä—É–±–ª–µ–π** –¥–ª—è –ò–ü
   - –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –ü–î

---

## üìã –ß–¢–û –ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨

### 1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç terms_of_service)

**–í–∞—Ä–∏–∞–Ω—Ç –ê:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É `terms_of_service`
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `document_type` ('privacy_policy' –∏–ª–∏ 'terms_of_service')
- –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å –≤ `terms_of_service` –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏

**–í–∞—Ä–∏–∞–Ω—Ç –ë:** –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `privacy_policies`
- –ë–æ–ª–µ–µ –≥–∏–±–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–æ–π –∏ –¥–æ–≥–æ–≤–æ—Ä–æ–º-–æ—Ñ–µ—Ä—Ç–æ–π

### 2. –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):**
```javascript
if (data === 'consent_agree') {
    await bot.answerCallbackQuery(callbackQuery.id, {
        text: '–°–æ–≥–ª–∞—Å–∏–µ –ø—Ä–∏–Ω—è—Ç–æ! ‚úÖ'
    });
    
    if (state && state.step === 'privacy_consent') {
        await finishRegistration(chatId, state.data); // ‚ùå –°–æ–≥–ª–∞—Å–∏–µ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
    }
    return;
}
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```javascript
if (data === 'consent_agree') {
    await bot.answerCallbackQuery(callbackQuery.id, {
        text: '–°–æ–≥–ª–∞—Å–∏–µ –ø—Ä–∏–Ω—è—Ç–æ! ‚úÖ'
    });
    
    if (state && state.step === 'privacy_consent') {
        // ‚úÖ –°–ù–ê–ß–ê–õ–ê —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–≥–ª–∞—Å–∏–µ –≤ –ë–î
        await savePrivacyConsent(chatId, state.data, callbackQuery);
        
        // –ü–û–¢–û–ú –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
        await finishRegistration(chatId, state.data);
    }
    return;
}
```

### 3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏—è

```javascript
async function savePrivacyConsent(chatId, registrationData, callbackQuery) {
    const dbClient = await pool.connect();
    try {
        await dbClient.query('BEGIN');
        
        // –ü–æ–ª—É—á–∞–µ–º ID –∫–ª–∏–µ–Ω—Ç–∞ (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
        // –ò–ª–∏ –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–µ—Ä—Å–∏—é –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
        const policyResult = await dbClient.query(
            `SELECT id, version FROM terms_of_service 
             WHERE is_active = true 
             ORDER BY effective_date DESC 
             LIMIT 1`
        );
        
        if (policyResult.rows.length === 0) {
            throw new Error('–ù–µ –Ω–∞–π–¥–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏');
        }
        
        const policy = policyResult.rows[0];
        
        // –ü–æ–ª—É—á–∞–µ–º client_id –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –∏–∑ finishRegistration)
        // –ò–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–≥–ª–∞—Å–∏–µ
        await dbClient.query(
            `INSERT INTO user_agreements (client_id, terms_id, ip_address, user_agent)
             VALUES ($1, $2, $3, $4)`,
            [
                clientId, // ID –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                policy.id,
                callbackQuery.from.id, // Telegram ID (IP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ –±–æ—Ç–µ)
                'Telegram Bot' // User agent
            ]
        );
        
        await dbClient.query('COMMIT');
    } catch (error) {
        await dbClient.query('ROLLBACK');
        throw error;
    } finally {
        dbClient.release();
    }
}
```

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É `terms_of_service`

**–ü–ª—é—Å—ã:**
- –¢–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ù–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `document_type` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏
- –ú–µ–Ω–µ–µ –≥–∏–±–∫–æ –¥–ª—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `privacy_policies`

**–ü–ª—é—Å—ã:**
- –ë–æ–ª–µ–µ –≥–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ –¥–æ–≥–æ–≤–æ—Ä–∞-–æ—Ñ–µ—Ä—Ç—ã
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–ª–∞–Ω—É –≤ `docs/privacy-consent-fix-plan.md`

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É
- –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: **–í–∞—Ä–∏–∞–Ω—Ç 2** (–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `privacy_policies`)

–ü–æ—á–µ–º—É:
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–ª–∞–Ω—É –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ë–æ–ª–µ–µ –≥–∏–±–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –õ–µ–≥—á–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–µ—Ä—Å–∏—è–º–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥–æ–≥–æ–≤–æ—Ä–∞-–æ—Ñ–µ—Ä—Ç—ã

---

## üìù –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `privacy_policies` (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –≤–∞—Ä–∏–∞–Ω—Ç 2)

```sql
CREATE TABLE privacy_policies (
    id SERIAL PRIMARY KEY,
    version VARCHAR(20) NOT NULL UNIQUE,
    title VARCHAR(255) NOT NULL,
    content TEXT NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    effective_date TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE privacy_consents (
    id SERIAL PRIMARY KEY,
    client_id INTEGER REFERENCES clients(id) ON DELETE CASCADE,
    policy_id INTEGER REFERENCES privacy_policies(id),
    consent_type VARCHAR(50) NOT NULL DEFAULT 'registration',
    telegram_id BIGINT, -- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
    consented_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(client_id, consent_type, policy_id)
);

CREATE INDEX idx_privacy_consents_client ON privacy_consents(client_id);
CREATE INDEX idx_privacy_consents_policy ON privacy_consents(policy_id);
CREATE INDEX idx_privacy_policies_active ON privacy_policies(is_active);
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏—è

### –®–∞–≥ 3: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### –®–∞–≥ 4: –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ –ë–î

---

## ‚ö†Ô∏è –í–´–í–û–î

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚ùå **–ù–ï –°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –§–ó-152**

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. –°–æ–≥–ª–∞—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
2. –ù–µ—Ç –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. –ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
4. –†–∏—Å–∫ —à—Ç—Ä–∞—Ñ–æ–≤ –æ—Ç –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä–∞

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–æ–≥–ª–∞—Å–∏–π
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏
4. –°–æ—Ö—Ä–∞–Ω—è—Ç—å IP, user agent, –≤—Ä–µ–º—è —Å–æ–≥–ª–∞—Å–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô** - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É

