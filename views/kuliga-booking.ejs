<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Бронирование тренировки на Кулиге | Горностайл72</title>
    <meta name="description" content="Забронируйте тренировку по горным лыжам или сноуборду на базе отдыха Кулига. Укажите данные, внесите предоплату через Tinkoff и получайте уведомления в Telegram." />
    <meta name="robots" content="noindex, follow">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/mobile.css">
    <link rel="stylesheet" href="/css/kuliga.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body class="kuliga-body">
    <header class="kuliga-booking-header">
        <a class="kuliga-booking-header__back" href="/instruktora-kuliga">
            <i class="fa-solid fa-arrow-left"></i>
            Вернуться на страницу Кулиги
        </a>
        <h1>Бронирование тренировки</h1>
        <p>Заполните данные участников, выберите занятие и внесите предоплату. После успешной оплаты мы предложим подключить Telegram-бота для уведомлений.</p>
    </header>

    <main class="kuliga-booking-main">
        <form id="kuligaBookingForm" class="kuliga-booking-form" novalidate>
            <section class="kuliga-booking-section">
                <h2>1. Параметры тренировки</h2>
                <div id="kuligaSelectionSummary" class="kuliga-selection-card">
                    <div class="kuliga-selection-card__title" data-selection-title>Загрузка параметров...</div>
                    <ul class="kuliga-selection-card__details" data-selection-details></ul>
                    <p class="kuliga-selection-card__note">
                        Чтобы изменить параметры тренировки, вернитесь к прайсу и выберите другую карточку.
                    </p>
                </div>
            </section>

            <section class="kuliga-booking-section">
                <h2>2. Данные заказчика</h2>
                <div class="kuliga-form-grid">
                    <label class="kuliga-field">
                        <span>ФИО заказчика *</span>
                        <input type="text" id="kuligaClientName" required maxlength="100" placeholder="Иванов Иван Иванович" autocomplete="name">
                    </label>
                    <label class="kuliga-field">
                        <span>Телефон для связи *</span>
                        <input type="tel" id="kuligaClientPhone" required maxlength="20" placeholder="+7 (999) 123-45-67" autocomplete="tel">
                    </label>
                    <label class="kuliga-field">
                        <span>Email (для чеков и уведомлений)</span>
                        <input type="email" id="kuligaClientEmail" maxlength="255" placeholder="name@example.com" autocomplete="email">
                    </label>
                </div>
                <div class="kuliga-choice kuliga-choice--inline">
                    <label class="kuliga-radio">
                        <input type="radio" name="kuligaPayerParticipation" value="self" checked>
                        <span>Я буду кататься</span>
                    </label>
                    <label class="kuliga-radio">
                        <input type="radio" name="kuligaPayerParticipation" value="other">
                        <span>Кататься будет другой человек</span>
                    </label>
                </div>
                <p class="kuliga-section-hint" id="kuligaParticipantsHint"></p>
            </section>

            <section class="kuliga-booking-section">
                <h2>3. Участники тренировки</h2>
                <div id="kuligaParticipantsContainer" class="kuliga-participants-grid"></div>
            </section>

            <section class="kuliga-booking-section">
                <h2>4. Дата и время</h2>
                <div class="kuliga-choice kuliga-choice--inline">
                    <label class="kuliga-radio">
                        <input type="radio" name="kuligaSportType" value="ski" checked>
                        <span>Горные лыжи</span>
                    </label>
                    <label class="kuliga-radio">
                        <input type="radio" name="kuligaSportType" value="snowboard">
                        <span>Сноуборд</span>
                    </label>
                </div>
                <div class="kuliga-form-grid kuliga-form-grid--compact">
                    <label class="kuliga-field">
                        <span>Дата тренировки *</span>
                        <input type="date" id="kuligaDate" required>
                    </label>
                    <label class="kuliga-field kuliga-field--full">
                        <span>Свободные слоты *</span>
                        <div id="kuligaTimeSlots" class="kuliga-timeslots" role="radiogroup" aria-live="polite"></div>
                    </label>
                </div>
                <div id="kuligaAvailabilityMessage" class="kuliga-inline-message" aria-live="polite"></div>
                <div id="kuligaInstructorCard" class="kuliga-instructor-preview" hidden>
                    <div class="kuliga-instructor-preview__photo">
                        <img id="kuligaInstructorPhoto" src="" alt="">
                    </div>
                    <div class="kuliga-instructor-preview__info">
                        <h3 id="kuligaInstructorName"></h3>
                        <p id="kuligaInstructorSport"></p>
                        <p id="kuligaInstructorDescription"></p>
                    </div>
                </div>
            </section>

            <section class="kuliga-booking-section">
                <h2>5. Уведомления</h2>
                <p class="kuliga-section-hint">Выберите, как получать подтверждение, изменения расписания и чек.</p>
                <label class="kuliga-checkbox">
                    <input type="checkbox" id="kuligaNotifyEmail" checked>
                    <span>Отправлять уведомления и чек на email</span>
                </label>
                <label class="kuliga-checkbox">
                    <input type="checkbox" id="kuligaNotifyTelegram">
                    <span>Получать уведомления в Telegram</span>
                </label>
                <div id="kuligaTelegramHint" class="kuliga-notify-hint" hidden>
                    <i class="fa-brands fa-telegram"></i>
                    <p>
                        Для уведомлений запустите бота <a id="kuligaTelegramLink" href="#" target="_blank" rel="noopener"></a> и нажмите «Старт».
                        После этого вернитесь к оплате. Форма сохранит введённые данные автоматически.
                    </p>
                </div>
            </section>

            <section class="kuliga-booking-section">
                <h2>6. Согласие</h2>
                <label class="kuliga-checkbox">
                    <input type="checkbox" id="kuligaConsent" required>
                    <span>
                        Я подтверждаю согласие на обработку персональных данных (ФИО, телефон, email) и разрешаю использование фото и видео с тренировки в социальных сетях и мессенджерах Горностайл72.
                        <a href="/privacy-policy" target="_blank" rel="noopener">Политика конфиденциальности</a>
                    </span>
                </label>
                <div class="kuliga-hint">
                    <i class="fa-solid fa-circle-info"></i>
                    Если тренировка не набирает минимальное количество участников до 22:00 накануне, мы автоматически отменим её и вернём предоплату на ваш счёт в течение 1-3 рабочих дней.
                </div>
            </section>

            <div class="kuliga-booking-summary">
                <div>
                    <span class="kuliga-summary__label">К оплате</span>
                    <strong id="kuligaTotalPrice">—</strong>
                </div>
                <button type="submit" class="kuliga-button kuliga-button--primary">Перейти к оплате</button>
            </div>
            <div id="kuligaBookingMessage" class="kuliga-message" role="status" aria-live="polite"></div>
        </form>
    </main>

    <footer class="kuliga-footer">
        <div class="kuliga-footer__content">
            <div class="kuliga-footer__brand">
                <img src="/images/logo.png" alt="Логотип Горностайл72" loading="lazy">
                <p>Горностайл72 — обучение горным лыжам и сноуборду круглый год. На Кулиге обучают инструкторы нашей школы.</p>
            </div>
            <div class="kuliga-footer__links">
                <a href="tel:+79123924956"><i class="fa-solid fa-phone"></i> +7 912 392-49-56</a>
                <a href="mailto:batl-zlat@yandex.ru"><i class="fa-solid fa-envelope"></i> batl-zlat@yandex.ru</a>
                <a href="https://t.me/<%= adminTelegramUsername %>" target="_blank" rel="noopener"><i class="fa-brands fa-telegram"></i> Telegram администратора</a>
                <a href="https://t.me/<%= botUsername %>" target="_blank" rel="noopener"><i class="fa-solid fa-robot"></i> Telegram-бот Горностайл72</a>
            </div>
        </div>
    </footer>

    <script>
        window.KULIGA_ANALYTICS = {
            yandexMetrikaId: '<%= yandexMetrikaId || '' %>',
            googleAnalyticsId: '<%= googleAnalyticsId || '' %>'
        };
    </script>
    <script>
        window.KULIGA_BOOKING_CONFIG = {
            botUsername: '<%= kuligaClientBotUsername || '' %>'
        };
    </script>
    <script src="/js/kuliga-booking.js" defer></script>
    <%- include('partials/analytics'); %>
</body>
</html>
