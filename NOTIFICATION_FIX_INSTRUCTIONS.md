# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º—ã —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `location` –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - `src/routes/kuliga-booking.js` - –¥–æ–±–∞–≤–ª–µ–Ω `location: slotLocation` –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É
   - `src/bot/client-bot.js` - –¥–æ–±–∞–≤–ª–µ–Ω `location` –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö (—Å–≤–æ—è –≥—Ä—É–ø–ø–∞ –∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –≥—Ä—É–ø–ø–∞)
   - `src/bot/admin-notify.js` - –¥–æ–±–∞–≤–ª–µ–Ω–æ —É–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

2. **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
   - `scripts/check-notifications-db.js` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üîß –®–∞–≥–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –®–∞–≥ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ SSH:
   ```bash
   ssh -L 6432:127.0.0.1:5432 root@5.129.248.187
   ```

2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
   ```bash
   # –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
   scp scripts/check-notifications-db.js root@5.129.248.187:/path/to/project/scripts/
   
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
   cd /path/to/project
   node scripts/check-notifications-db.js
   ```

   –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ —Å —Ç—É–Ω–Ω–µ–ª–µ–º:
   ```bash
   # –í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–æ–¥–Ω—è—Ç—å —Ç—É–Ω–Ω–µ–ª—å
   ssh -L 6432:127.0.0.1:5432 root@5.129.248.187
   
   # –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
   cd /home/dan/Project/gornostyle
   node scripts/check-notifications-db.js
   ```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –µ—Å—Ç—å `telegram_id`
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–º–µ—é—Ç `location`
   - –ù–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–∞–ø–∏—Å–∏

### –®–∞–≥ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞–π–¥–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã, –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –±–µ–∑ telegram_id
SELECT id, full_name, telegram_id FROM kuliga_instructors WHERE is_active = true AND telegram_id IS NULL;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø–∏—Å–∏ –±–µ–∑ location (–µ—Å–ª–∏ –µ—Å—Ç—å)
SELECT id, date, location FROM kuliga_bookings WHERE location IS NULL AND date >= CURRENT_DATE - INTERVAL '2 days';
SELECT id, date, location FROM kuliga_schedule_slots WHERE location IS NULL AND date >= CURRENT_DATE - INTERVAL '2 days';
SELECT id, date, location FROM kuliga_group_trainings WHERE location IS NULL AND date >= CURRENT_DATE - INTERVAL '2 days';
```

### –®–∞–≥ 3: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫–æ–¥–∞

1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   scp src/routes/kuliga-booking.js root@5.129.248.187:/path/to/project/src/routes/
   scp src/bot/client-bot.js root@5.129.248.187:/path/to/project/src/bot/
   scp src/bot/admin-notify.js root@5.129.248.187:/path/to/project/src/bot/
   ```

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏):
   ```bash
   # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PM2
   pm2 restart all
   
   # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è systemd
   sudo systemctl restart your-app-name
   
   # –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Node.js
   ```

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–∞–π—Ç –∏–ª–∏ –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–µ–π:
   ```
   [NOTIFY] –í—ã–∑–æ–≤ notifyInstructorKuligaTrainingBooking...
   [NOTIFY] ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É...
   ```
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—É—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

### –®–∞–≥ 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í —Ç–µ—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ (–ø—Ä–∏–º–µ—Ä –¥–ª—è PM2)
pm2 logs | grep NOTIFY

# –ò–ª–∏ –¥–ª—è systemd
journalctl -u your-app-name -f | grep NOTIFY
```

## üìã –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. `src/routes/kuliga-booking.js`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∞–π—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è `location` –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞:
```javascript
location: slotLocation // –ú–ò–ì–†–ê–¶–ò–Ø 038: –ü–µ—Ä–µ–¥–∞–µ–º location
```

### 2. `src/bot/client-bot.js` (—Ñ—É–Ω–∫—Ü–∏—è `createKuligaOwnGroupBooking`)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤–æ–µ–π –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è `location` –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ location –∏–∑ state –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
```javascript
const location = state.data.location || 'kuliga';
// ... –≤ notifyInstructorKuligaTrainingBooking
location: location, // –ú–ò–ì–†–ê–¶–ò–Ø 038: –ü–µ—Ä–µ–¥–∞–µ–º location
```

### 3. `src/bot/client-bot.js` (—Ñ—É–Ω–∫—Ü–∏—è `createKuligaExistingGroupBooking`)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≥—Ä—É–ø–ø—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è `location` –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ location (–∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –ø–æ–ª—É—á–µ–Ω –≤—ã—à–µ):
```javascript
location: location, // –ú–ò–ì–†–ê–¶–ò–Ø 038: –ü–µ—Ä–µ–¥–∞–µ–º location
```

### 4. `src/bot/admin-notify.js`
**–£–ª—É—á—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∞ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `telegram_id` —É –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞** - –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–æ—Ç–µ
2. **NULL –∑–Ω–∞—á–µ–Ω–∏—è `location`** - —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –º–æ–≥–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç—å location –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ `location`** - –∫–æ–¥ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª location –≤ —Ñ—É–Ω–∫—Ü–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–í—Å–µ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ—à–µ–Ω—ã –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.

