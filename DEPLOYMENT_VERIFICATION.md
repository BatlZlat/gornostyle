# üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PM2
pm2 status

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ (–æ–±—â–∏–µ)
pm2 logs gornostyle --lines 50 --nostream

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫
pm2 logs gornostyle --err --lines 30 --nostream | grep -i "error\|fail\|exception"

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
pm2 logs gornostyle --lines 100 --nostream | grep -i "booking\|email\|webhook\|client_id\|bookingData"

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs gornostyle --lines 20 --nostream | grep -i "listening\|started\|ready\|server"
```

## –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
./scripts/check-deployment-logs.sh
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π

### ‚úÖ –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:

1. **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
   ```
   üìù [GroupBooking] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bookingData: client_id=X, client_email=...
   üíæ [Booking] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ #X —Å paymentData, bookingData —Å–æ—Ö—Ä–∞–Ω–µ–Ω: client_id=X
   üîó [Payment] SUCCESS_URL —Å clientId: ...?clientId=X
   ```

2. **–ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ webhook:**
   ```
   üîç [Webhook] provider_raw_data –∏–∑ –ë–î (—Ç–∏–ø: ...)
   üîç [Webhook] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ bookingData –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ #X:
      ‚úÖ bookingData –Ω–∞–π–¥–µ–Ω:
         - client_id: X
         - client_email: ...
   üîç [Webhook] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è bookingData: hasBookingData=true
   ‚úÖ [Webhook] bookingData —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ updatedRawData: client_id=X
   üìß –ü—Ä–æ–≤–µ—Ä–∫–∞ email –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏: client_email=..., –≤–∞–ª–∏–¥–Ω—ã–π=true
   ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç—É ...
   ```

3. **–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ –±–æ—Ç–∞:**
   ```
   üîç [Bot /start] –ü–æ–ª—É—á–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä: "client_X" –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ...
   üîó [Bot /start] Deep link —Å client_id: X
   ‚úÖ –ö–ª–∏–µ–Ω—Ç #X —É—Å–ø–µ—à–Ω–æ —Å–≤—è–∑–∞–Ω —Å Telegram ...
   ```

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ:

1. **–û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π:**
   ```
   Error: Cannot find module '...'
   ```
   ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä

2. **–û—à–∏–±–∫–∏ –ë–î:**
   ```
   error: relation "..." does not exist
   ```
   ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

3. **–û—à–∏–±–∫–∏ email:**
   ```
   –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email –∫–ª–∏–µ–Ω—Ç—É: ...
   ```
   ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ EMAIL_PASS –≤ .env

4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ bookingData:**
   ```
   ‚ùå [Webhook] bookingData –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ rawData!
   ```
   ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
node scripts/check-booking-data.js <transactionId>

# –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
node scripts/test-booking-flow.js --type=individual
```

